@model PresentationLayer.ViewModels.UserManagement.UserManagementViewModel

@{
    Layout = "_AdminLayout";
    ViewData["Title"] = "Users Management";
}

<div class="bg-white rounded-xl shadow-sm border border-zinc-200 overflow-hidden">

    <!-- Header -->
    <div class="px-6 py-4 border-b border-zinc-200 flex items-center justify-between">
        <h2 class="text-xl font-semibold text-zinc-900 flex items-center gap-2">
            <i class="fas fa-users"></i>
            Manage Users
        </h2>
    </div>

    <!-- Table -->
    <div class="overflow-x-auto">
        <table class="w-full">
            <thead class="bg-zinc-50">
                <tr>
                    <th class="px-6 py-3 text-left text-xs font-semibold text-zinc-500 uppercase">User</th>
                    <th class="px-6 py-3 text-left text-xs font-semibold text-zinc-500 uppercase">Email</th>
                    <th class="px-6 py-3 text-left text-xs font-semibold text-zinc-500 uppercase">Phone</th>
                    <th class="px-6 py-3 text-left text-xs font-semibold text-zinc-500 uppercase">Role</th>
                    <th class="px-6 py-3 text-left text-xs font-semibold text-zinc-500 uppercase">Status</th>
                    <th class="px-6 py-3 text-left text-xs font-semibold text-zinc-500 uppercase">Created At</th>
                    <th class="px-6 py-3 text-left text-xs font-semibold text-zinc-500 uppercase">Actions</th>
                </tr>
            </thead>

            <tbody class="bg-white divide-y divide-zinc-200">
                @if (Model.Users != null && Model.Users.Any())
                {
                    foreach (var user in Model.Users)
                    {
                        <tr class="hover:bg-zinc-50 transition-colors">
                            <!-- User -->
                            <td class="px-6 py-4">
                                <div class="flex items-center gap-3">
                                    <div class="w-9 h-9 rounded-full bg-indigo-600 flex items-center justify-center text-white font-semibold text-sm">
                                        @(string.IsNullOrEmpty(user.FullName)
                                                                        ? "U"
                                                                        : user.FullName.Substring(0, 1).ToUpper())
                                                                                                              </div>
                                                                                                              <span class="font-semibold text-zinc-900">
                                                                                                                  @user.FullName
                                                                                                              </span>
                                                                                                          </div>
                                                                                                      </td>

                            <!-- Email -->
                            <td class="px-6 py-4 text-sm text-zinc-600">
                                @user.Email
                            </td>

                            <!-- Phone -->
                            <td class="px-6 py-4 text-sm text-zinc-600">
                                @user.PhoneNumber
                            </td>

                            <!-- Role -->
                            <td class="px-6 py-4">
                                <span class="inline-flex px-3 py-1 rounded-full text-xs font-semibold
                                        @(user.Role.ToString() == "Instructor"
                                                                          ? "bg-amber-100 text-amber-700"
                                                                          : "bg-emerald-100 text-emerald-700")">
                                                                                                            @user.Role
                                                                                                        </span>
                                                                                                    </td>

                            <!-- Status -->
                            <td class="px-6 py-4">
                                <span class="inline-flex px-3 py-1 rounded-full text-xs font-semibold
                                        @(user.IsVerfied
                                                                          ? "bg-emerald-100 text-emerald-700"
                                                                          : "bg-red-100 text-red-700")">
                            @(user.IsVerfied ? "Verified" : "Unverified")
                        </span>
                    </td>

                            <!-- Created -->
                            <td class="px-6 py-4 text-sm text-zinc-600">
                                @user.CreatedAt.ToString("dd/MM/yyyy")
                            </td>

                            <!-- Actions -->
                            <td class="px-6 py-4">
                                <div class="flex gap-2">
                                    <a asp-action="EditUser"
                                       asp-route-id="@user.UserId"
                                       class="inline-flex items-center gap-1 px-3 py-2 bg-blue-50 text-blue-600 text-sm font-medium rounded-lg hover:bg-blue-600 hover:text-white">
                                        <i class="fas fa-edit"></i>
                                        Edit
                                    </a>

                                    <form asp-action="DeleteUser"
                                          method="post"
                                          onsubmit="return confirm('Are you sure you want to delete this user?')">
                                        <input type="hidden" name="userId" value="@user.UserId" />
                                        <button type="submit"
                                                class="p-2 bg-red-50 text-red-600 rounded-lg hover:bg-red-600 hover:text-white">
                                            <i class="fas fa-trash"></i>
                                        </button>
                                    </form>
                                </div>
                            </td>
                        </tr>
                                }
                }
                else
                {
                    <tr>
                        <td colspan="7" class="text-center py-6 text-zinc-500">
                            No users found
                        </td>
                    </tr>
                }
            </tbody>
        </table>
    </div>

    <!-- Pagination -->
    <div class="px-6 py-4 border-t border-zinc-200 flex items-center justify-between">
        <div class="text-sm text-zinc-500">
            Showing
            @(((Model.PageNumber - 1) * Model.PageSize) + 1)
            -
            @(Math.Min(Model.PageNumber * Model.PageSize, Model.TotalCount))
            of @Model.TotalCount users
        </div>

        <div class="flex gap-1">
            @for (int i = 1; i <= Model.TotalPages; i++)
            {
                <a asp-action="Users"
                   asp-route-pageNumber="@i"
                   asp-route-pageSize="@Model.PageSize"
                   class="px-3 py-2 text-sm font-medium rounded-lg
                       @(i == Model.PageNumber
                                           ? "bg-indigo-600 text-white"
                                           : "bg-white border border-zinc-300 text-zinc-700 hover:bg-zinc-50")">
                @i
            </a>
                        }
        </div>
    </div>
</div>