@model BusinessLayer.Requests.Course.CreateNewCourseRequest
@{
    ViewData["Title"] = "Create Course";
    Layout = "_AdminLayout";
}

<partial name="_Notification" />

<div class="max-w-2xl mx-auto space-y-6">
    <!-- Header -->
    <div class="flex items-center gap-4">
        <a asp-action="Dashboard" class="p-2 text-zinc-500 hover:text-zinc-900 hover:bg-zinc-100 rounded-lg transition-colors">
            <i class="fas fa-arrow-left"></i>
        </a>
        <div>
            <h1 class="text-2xl font-bold text-zinc-900">Create New Course</h1>
            <p class="text-zinc-500 mt-1">Fill in the details to create your course</p>
        </div>
    </div>

    <!-- Form -->
    <form asp-action="Create" method="post" enctype="multipart/form-data" class="bg-white rounded-xl border border-zinc-200 p-6 space-y-6" x-data="{ imagePreview: null, loading: false }" x-on:submit="loading = true">
        @Html.AntiForgeryToken()

        <!-- Title -->
        <div>
            <label for="Title" class="block text-sm font-medium text-zinc-700 mb-2">Course Title *</label>
            <input type="text" name="Title" id="Title" value="@Model?.Title" required
                   class="w-full px-4 py-2.5 border border-zinc-300 rounded-lg focus:ring-2 focus:ring-zinc-900 focus:border-transparent transition-all"
                   placeholder="e.g., Introduction to Web Development">
            <span asp-validation-for="Title" class="text-sm text-red-500 mt-1"></span>
        </div>

        <!-- Description -->
        <div>
            <label for="Description" class="block text-sm font-medium text-zinc-700 mb-2">Description *</label>
            <textarea name="Description" id="Description" rows="4" required
                      class="w-full px-4 py-2.5 border border-zinc-300 rounded-lg focus:ring-2 focus:ring-zinc-900 focus:border-transparent transition-all resize-none"
                      placeholder="Describe what students will learn...">@Model?.Description</textarea>
            <span asp-validation-for="Description" class="text-sm text-red-500 mt-1"></span>
        </div>

        <!-- Level & Price Row -->
        <div class="grid grid-cols-2 gap-4">
            <div>
                <label for="Level" class="block text-sm font-medium text-zinc-700 mb-2">Level *</label>
                <select name="Level" id="Level" required
                        class="w-full px-4 py-2.5 border border-zinc-300 rounded-lg focus:ring-2 focus:ring-zinc-900 focus:border-transparent transition-all bg-white">
                    <option value="0">Beginner</option>
                    <option value="1">Intermediate</option>
                    <option value="2">Advanced</option>
                </select>
            </div>
            <div>
                <label for="Price" class="block text-sm font-medium text-zinc-700 mb-2">Price ($)</label>
                <input type="number" name="Price" id="Price" value="0" min="0" step="0.01"
                       class="w-full px-4 py-2.5 border border-zinc-300 rounded-lg focus:ring-2 focus:ring-zinc-900 focus:border-transparent transition-all"
                       placeholder="0 for free">
                <p class="text-xs text-zinc-500 mt-1">Set to 0 for free courses</p>
            </div>
        </div>

        <!-- Image Upload -->
        <div>
            <label class="block text-sm font-medium text-zinc-700 mb-2">Course Thumbnail</label>
            <div class="border-2 border-dashed border-zinc-300 rounded-lg p-6 text-center hover:border-zinc-400 transition-colors relative">
                <template x-if="!imagePreview">
                    <div>
                        <i class="fas fa-cloud-upload-alt text-3xl text-zinc-400 mb-2"></i>
                        <p class="text-sm text-zinc-600 mb-2">Drag & drop or click to upload</p>
                        <p class="text-xs text-zinc-500">PNG, JPG up to 5MB</p>
                    </div>
                </template>
                <template x-if="imagePreview">
                    <div class="relative inline-block">
                        <img :src="imagePreview" class="max-h-48 rounded-lg mx-auto">
                        <button type="button" @@click="imagePreview = null; $refs.imageInput.value = ''"
                                class="absolute -top-2 -right-2 p-1 bg-red-500 text-white rounded-full hover:bg-red-600 transition-colors">
                            <i class="fas fa-times text-xs"></i>
                        </button>
                    </div>
                </template>
                <input type="file" name="ImageFile" id="ImageFile" accept="image/*" x-ref="imageInput"
                       class="absolute inset-0 w-full h-full opacity-0 cursor-pointer"
                       @@change="const file = $event.target.files[0]; if(file) { const reader = new FileReader(); reader.onload = e => imagePreview = e.target.result; reader.readAsDataURL(file); }">
            </div>
        </div>

        <!-- Submit -->
        <div class="flex items-center justify-end gap-3 pt-4 border-t border-zinc-100">
            <a asp-action="Dashboard" class="px-4 py-2.5 text-zinc-600 hover:text-zinc-900 font-medium transition-colors" :class="loading && 'pointer-events-none opacity-50'">
                Cancel
            </a>
            <button type="submit" :disabled="loading" class="px-6 py-2.5 bg-zinc-900 text-white rounded-lg hover:bg-zinc-800 transition-colors font-medium disabled:opacity-50 disabled:cursor-not-allowed flex items-center gap-2">
                <template x-if="loading">
                    <svg class="animate-spin h-4 w-4" xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24">
                        <circle class="opacity-25" cx="12" cy="12" r="10" stroke="currentColor" stroke-width="4"></circle>
                        <path class="opacity-75" fill="currentColor" d="M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4z"></path>
                    </svg>
                </template>
                <span x-text="loading ? 'Creating...' : 'Create Course'"></span>
            </button>
        </div>
    </form>
</div>
